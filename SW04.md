# ðŸ“˜ Woche 4 â€“ Grundlagen in Pandas

Diese Zusammenfassung behandelt zentrale Funktionen von **Pandas**, einer der wichtigsten Bibliotheken zur Datenanalyse in Python.  
Sie basiert auf dem Notebook *05-Grundlagen_in_Pandas* sowie den Ãœbungen und LÃ¶sungen aus *05-Uebungen*.

---

## 1. Series in Pandas

- 1-dimensionale Datenstruktur, Ã¤hnlich wie ein Array oder eine Liste.
- Besteht aus **Werten** und **Indizes**.

**Beispiel:**
```python
import pandas as pd

ser1 = pd.Series([1, -2, 3, 0, 5, 2])
ser1.index = list('abcdef')
```

---

## 2. Zugriff auf Series-Daten

- Einzelner Wert: `ser1['c']`
- Slicing nach Indexposition: `ser1[:2]`
- Slicing nach Label: `ser1[:'b']`
- Letztes Element: `ser1.iloc[-1]` oder `ser1['f']`
- Mehrere Werte: `ser1[['b', 'e']]`

---

## 3. Kopien & Manipulation

- Kopieren: `ser1_c = ser1.copy()`
- Einzelwert Ã¤ndern: `ser1_c['f'] = -2`
- Existenz prÃ¼fen: `'g' in ser1`
- Nur negative Werte filtern: `ser1[ser1 < 0]`
- Negative Werte ersetzen: `ser1_c[ser1_c < 0] = 0`

---

## 4. Series aus Dictionary & Rechnen mit Series

**Beispiel:**
```python
dict1 = {'a': 100, 'b': 120, 'd': 95, 'e': 105, 'f': 80, 'g': 105}
ser2 = pd.Series(dict1)

resultat = ser1 + ser2  # Addition nach Index
resultat[resultat.notna()]  # Nur gÃ¼ltige Werte
```

---

## 5. Sortieren von Series

- Nach Werten aufsteigend: `ser1.sort_values()`
- Absteigend: `ser1.sort_values(ascending=False)`

---

## 6. DataFrames â€“ EinfÃ¼hrung

- 2-dimensionale Datenstruktur: Tabelle mit Spalten und Zeilen

**Beispiel:**
```python
import numpy as np

rng = np.random.default_rng(7)
n = 12
Zivilstand = rng.choice(['l','v','g','vw'], size=n)

dflohn = pd.DataFrame({
    'Personen_ID': range(100, 100+n),
    'Lohn': rng.lognormal(mean=8.6, sigma=0.4, size=n).astype(int),
    'Geschlecht': rng.choice(['w', 'm'], size=n),
    'Alter': rng.integers(18, 65, size=n)
})
```

---

## 7. DataFrame: Zugriff & Indexierung

- `.head()` / `.tail()` â€“ erste / letzte Zeilen
- Spalte auswÃ¤hlen: `dflohn['Lohn']` oder `dflohn.Lohn`
- Index setzen: `dflohn.set_index('Personen_ID', inplace=True)`
- Spalte umbenennen: `dflohn.rename(columns={'Lohn': 'Gehalt'}, inplace=True)`
- Neue Spalte hinzufÃ¼gen: `dflohn['Zivilstand'] = Zivilstand`
- Zeile per Label: `dflohn.loc[104]`
- Zeile per Position: `dflohn.iloc[4]`
- Zeile lÃ¶schen: `dflohn.drop(101, inplace=True)`
- Slicing nach Label: `dflohn.loc[103:106]`
- Mehrere Spalten auswÃ¤hlen: `dflohn.loc[103:106, ['Geschlecht', 'Zivilstand']]`
- Zeilen mit Bedingung: `dflohn[dflohn.Geschlecht == 'w']`
- Wert als NaN setzen: `dflohn.loc[104, 'Gehalt'] = None`

---

## 8. Deskriptive Statistik mit Pandas

- Maximum: `dflohn.Gehalt.max()`
- Zeile mit Maximum: `dflohn[dflohn.Gehalt == dflohn.Gehalt.max()]`
- Mittelwert & Median:
```python
dflohn[['Alter', 'Gehalt']].mean()
dflohn[['Alter', 'Gehalt']].median()
```
- Zusammenfassung: `dflohn.describe()`
- Nur bestimmte Zeilen extrahieren: `dflohn.describe().loc[['count', '25%']]`

---

## 9. HÃ¤ufigkeitsverteilungen

- Absolute HÃ¤ufigkeit: `dflohn.Zivilstand.value_counts()`
- Relative HÃ¤ufigkeit: `dflohn.Zivilstand.value_counts(normalize=True)`

---

## 10. Beispiel: Aktienkurse analysieren

Daten mit `pd.read_pickle()` laden:

```python
Preise = pd.read_pickle('yahoo_price.pkl')
Preise.head()
```

---

## 11. Plotten mit Pandas

```python
Preise.plot();  # Zeitreihe
```

---

## 12. Rebasierte Zeitreihen

Alle Kurse starten mit 100:
```python
Preise100 = Preise / Preise.iloc[0] * 100
Preise100.plot();
```

---

## 13. Gesamtrendite (HPR â€“ Holding Period Return)

**Definition:**
```python
def HPR(P):
    return (P.iloc[-1] / P.iloc[0] - 1) * 100

HPR(Preise)
# oder:
Preise.agg(HPR)
```

---

## 14. Tagesrenditen berechnen

```python
Renditen = Preise.pct_change()
Renditen.head()
```

---

## âœ… Fazit Woche 4

Mit Pandas lassen sich komplexe Datenanalysen sehr elegant und effizient durchfÃ¼hren â€“  
von einfachen 1D-Arrays (Series) bis hin zu DataFrames mit realen Daten.  
Wichtige Themen dieser Woche: **Indexierung, Filtern, Aggregation, Zeitreihenanalyse, Datenmanipulation**.
