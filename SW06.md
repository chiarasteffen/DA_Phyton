# ğŸ“˜ Woche 6 â€“ Daten sÃ¤ubern & transformieren

Diese Woche konzentriert sich auf das **Vorbereiten von Daten** fÃ¼r die Analyse:  
Fehlwerte, Umkodierungen, Duplikate, Gruppierungen, Binning, Zensierung, Stichproben und String-Manipulation mit Pandas.

---

## 1. ğŸ§¼ Umgang mit Fehlwerten (NaN)

### NaN erkennen
```python
df.isna()                # True/False fÃ¼r jede Zelle
df.isna().sum()          # Anzahl NaN pro Spalte
df.isna().mean()         # Anteil NaN pro Spalte
```

### NaN entfernen
```python
df.dropna()              # Zeilen mit NaN entfernen
df.dropna(axis=1)        # Spalten mit NaN entfernen
```

### NaN ersetzen
```python
df.fillna(0)             # Alle NaN mit 0 ersetzen
df['Lohn'].fillna(df['Lohn'].median())  # Mit Median ersetzen
```

---

## 2. ğŸ§¾ Duplikate erkennen & entfernen

- Zeilen, die vollstÃ¤ndig identisch sind:
```python
df.duplicated().sum()       # Anzahl Duplikate
df.drop_duplicates()        # Duplikate lÃ¶schen
```

- Eindeutigkeit des Index prÃ¼fen:
```python
df.index.is_unique          # True/False
```

---

## 3. ğŸ” Werte umkodieren (replace)

Beispiel: Zivilstand umbenennen:
```python
mapping = {'v': 'verh', 'vw': 'verw'}
df['Zivilstand'].replace(mapping, inplace=True)
```

---

## 4. ğŸ·ï¸ Spalten umbenennen

```python
df.rename(columns={'Lohn': 'Monatslohn'}, inplace=True)
```

---

## 5. ğŸ“Š Gruppierung / Binning (z.â€¯B. Altersklassen)

### Beispiel: Altersklassen in 10-Jahres-Schritte
```python
bins = range(15, 66, 10)
df['Altersklasse'] = pd.cut(df['Alter'], bins)
```

### Absolute HÃ¤ufigkeit:
```python
df['Altersklasse'].value_counts().sort_index()
```

### Relative HÃ¤ufigkeit:
```python
df['Altersklasse'].value_counts(normalize=True).sort_index()
```

---

## 6. âœ‚ï¸ Zensierung (Clip)

Beispiel: Werte Ã¼ber dem 95%-Quantil begrenzen
```python
p95 = df['Lohn'].quantile(0.95)
df['Lohn'] = df['Lohn'].clip(upper=p95)
```

---

## 7. ğŸ“‰ Histogramm erstellen

Verteilung (z.â€¯B. von LÃ¶hnen) anzeigen:
```python
df['Lohn'].hist()
```

---

## 8. ğŸ§ª Stichprobe ziehen

Beispiel: 5% Zufallsstichprobe (ohne ZurÃ¼cklegen)
```python
sample = df.sample(frac=0.05, random_state=10)
```

---

## 9. ğŸ§  Dummy-Variablen erzeugen

### Automatisch:
```python
pd.get_dummies(df, columns=['Geschlecht'], drop_first=True)
```

### Manuell fÃ¼r â€wâ€œ (Frau):
```python
df['Geschlecht_w'] = (df['Geschlecht'] == 'w').astype(int)
```

---

## 10. ğŸ”¤ String-Operationen mit `str`

Beispiel-String:
```python
s = 'peter_vogt@test.com, m.mueller@test.com, banz(at)zhaw.ch'
emails = s.split(', ')
```

### In Pandas Series umwandeln:
```python
emails = pd.Series(emails)
```

### Zeichen ersetzen:
```python
emails.str.replace('(at)', '@', regex=False)
```

### StringprÃ¼fung:
```python
emails.str.endswith('.ch')        # Gibt Series mit True/False
emails.str.endswith('.ch').sum()  # ZÃ¤hlt EintrÃ¤ge mit '.ch'
```

---

## âœ… Fazit Woche 6

In dieser Woche hast du zentrale Werkzeuge fÃ¼r die **Datenbereinigung & -transformation** gelernt:

- **Fehlwerte erkennen, entfernen oder ersetzen**
- **Duplikate & Inkonsistenzen behandeln**
- **Gruppieren & Binning (z.â€¯B. Altersklassen)**
- **Zensierung extremer Werte (Quantile)**
- **Zufallsstichproben ziehen**
- **Dummy-Variablen erzeugen**
- **Stringmanipulationen fÃ¼r Textdaten**

Diese Techniken sind essenziell fÃ¼r eine korrekte Datenanalyse und bereiten deine Daten auf statistische Verfahren und Visualisierungen vor.
